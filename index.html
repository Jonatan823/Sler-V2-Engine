<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SLER - IDE LOGÍSTICO v2</title>
    <style>
        :root { --bg: #1e1e1e; --panel: #2d2d2d; --text: #d4d4d4; --accent: #007acc; }
        body { font-family: 'Segoe UI', monospace; background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Panel Lateral de Control */
        #sidebar { width: 250px; background: var(--panel); border-right: 1px solid #444; padding: 20px; display: flex; flex-direction: column; gap: 20px; }
        .status-box { border: 1px solid #555; padding: 10px; font-size: 11px; }
        .status-on { color: #89d185; }

        /* Área de Trabajo Principal */
        #main-ide { flex: 1; display: flex; flex-direction: column; position: relative; }
        #terminal { flex: 1; overflow-y: auto; padding: 20px; font-size: 14px; background: #161616; border-bottom: 1px solid #444; }
        
        /* Burbujas Estilo Logístico */
        .log-entry { margin-bottom: 12px; border-left: 2px solid var(--accent); padding-left: 10px; }
        .log-user { font-weight: bold; color: var(--accent); font-size: 12px; }
        .log-text { margin-top: 4px; line-height: 1.4; }

        /* Input de Comando */
        .command-line { padding: 20px; background: var(--panel); display: flex; gap: 10px; }
        textarea { flex: 1; background: #3c3c3c; border: 1px solid #555; color: white; padding: 10px; resize: none; height: 50px; }
        button { background: var(--accent); color: white; border: none; padding: 0 20px; cursor: pointer; font-weight: bold; }

        /* Pantalla de Acceso */
        #auth-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        input { background: #3c3c3c; border: 1px solid var(--accent); color: white; padding: 10px; text-align: center; width: 200px; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div id="auth-overlay">
        <h2>SLER LOGISTIC INTERFACE</h2>
        <input type="text" id="nick" placeholder="NICKNAME">
        <button id="btn-entrar" style="height: 40px;">AUTORIZAR INGRESO</button>
    </div>

    <div id="sidebar">
        <h3>CONTROLES</h3>
        <div class="status-box">
            <div>ESTADO: <span class="status-on">ONLINE</span></div>
            <div>MOTOR V2: <span id="motor-status">ESPERANDO...</span></div>
            <div>PROPIEDAD: Ribot Jonatan</div>
        </div>
        <div style="font-size: 10px; color: #888;">Protocolo de No Conflicto v1.0 activado.</div>
    </div>

    <div id="main-ide">
        <div id="terminal"></div>
        <div class="command-line">
            <textarea id="texto" placeholder="Escribir cadena para procesar..."></textarea>
            <button id="btn-enviar">EJECUTAR</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyD5ITa76Xc7mmihQPC2AUCHQFStii4NAUg",
            authDomain: "sler-chat-lab.firebaseapp.com",
            databaseURL: "https://sler-chat-lab-default-rtdb.firebaseio.com",
            projectId: "sler-chat-lab",
            storageBucket: "sler-chat-lab.firebasestorage.app",
            messagingSenderId: "594954603335",
            appId: "1:594954603335:web:d332aa211e8ecce5521a62"
        };

        firebase.initializeApp(firebaseConfig);
        var db = firebase.database();

        // 1. PROTOCOLO DE NO CONFLICTO (Simulación de Permiso)
        db.ref('sistema/motor_v2').set({
            permiso: "AUTORIZADO",
            propietario: "Ribot Jonatan",
            timestamp: Date.now()
        });

        // UI Elements
        var btnEntrar = document.getElementById('btn-entrar');
        var btnEnviar = document.getElementById('btn-enviar');
        var authOverlay = document.getElementById('auth-overlay');
        var nickInput = document.getElementById('nick');
        var textoInput = document.getElementById('texto');
        var terminal = document.getElementById('terminal');

        btnEntrar.onclick = function() {
            if (nickInput.value.trim() !== "") {
                authOverlay.style.display = 'none';
                document.getElementById('motor-status').innerText = "AUTORIZADO";
                document.getElementById('motor-status').className = "status-on";
            }
        };

        btnEnviar.onclick = function() {
            var msj = textoInput.value.trim();
            if (msj !== "") {
                db.ref('mensajes').push({
                    usuario: nickInput.value,
                    contenido: msj,
                    timestamp: Date.now()
                });
                textoInput.value = "";
            }
        };

        // Escucha en tiempo real
        db.ref('mensajes').on('child_added', function(data) {
            var msg = data.val();
            var div = document.createElement('div');
            div.className = 'log-entry';
            div.innerHTML = '<div class="log-user">[' + msg.usuario + ']</div><div class="log-text">' + msg.contenido + '</div>';
            terminal.appendChild(div);
            terminal.scrollTop = terminal.scrollHeight;
        });
    </script>
</body>
</html>
